<project name="Warranty" basedir="." default="generate.report">

	<property file="${basedir}/project.properties"/>
	<property file="${xradar.home}/xradar.properties"/>

	<target name="run.xradar">
		<exec executable="xradar.bat" />
	</target>

	<target name="generate.report" depends="statics_all, deleteBuildAndPropertiesFiles">
		<echo message="generated the xradar report and delete unnecessary files."/>
	</target>

	<target name="deleteBuildAndPropertiesFiles" description="deletes the xradar-build.xml and statics.properties from all modules." >
		<delete file="etc/statics.properties"/>
		<delete file="build.xml"/>
		<delete file="xradar.bat"/>
	</target>

	<taskdef resource="net/sf/antcontrib/antlib.xml">
		<classpath>
			<fileset dir="${xradar.home}/lib">
				<include name="*.jar"/>
			</fileset>
		</classpath>
	</taskdef>

	<target name="statics_all" description="Runs statics reports for all historic radar versions">
		<foreach list="${version.list}" target="statics" param="version" trim="true" inheritall="true"/>
		<antcall target="clean.xradar" />
	</target>

	<target name="statics_current" description="Runs statics reports for all historic radar versions">
		<property name="version" value="${version.current}"/>
		<antcall target="statics"/>
	</target>

	<target name="statics" description="Runs statics reports for a given version, defined with -Dversion=4 (for instance)">
		<ant antfile="${xradar.home}/project_targets.xml" target="statics"/>
	</target>

	<target name="clean.xradar" description="Cleans the gen folder generated by Xradar" >
		<delete dir="gen" />
	</target>

</project>